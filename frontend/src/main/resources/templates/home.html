<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.w3.org/1999/xhtml">

    <title>Twitter</title>
    <head th:replace="fragment/header :: head"></head>

    <body>
        <div th:replace="fragment/menu :: div"></div>
        <div class="container">

            <div class="row justify-content-center">

                <div class="col-3">
                    <!------------ PROFILE BOX ------------->
                    <div class="profile-box">
                        <img th:src="@{'/static/images/profile/' + ${profile.profileImageName} }" class="profile-box-pic">
                        <div class="profile-box-top-box"></div>

                        <div class="profile-box-bottom-box">
                            <div class="name-box">
                                <span class="profile-name" th:text="${profile.firstName} + ' ' + ${profile.lastName}"></span><br>
                                <span class="handle-name" th:text=" '@' + ${profile.userName}"></span>
                            </div>
                            <table class="follow-stat-table">
                                <thead>
                                    <tr>
                                        <th class="follow-stat-header">Tweets</th>
                                        <th class="follow-stat-header">Following</th>
                                        <th class="follow-stat-header">Followers</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td class="follow-stat-number" th:text="${totalTweets}"></td>
                                        <td class="follow-stat-number" th:text="${followingCount}"></td>
                                        <td class="follow-stat-number" th:text="${followerCount}"></td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <div class="col-6">

                    <!--------- POST NEW TWEET --------->
                    <div class="post-tweet-box">
                        <div class="newtweet-box-image-box">
                            <img class="newtweet-profile-pic" th:src="@{'/assets/profile-new.png'}">
                        </div>
                        <div class="outer">
                            <form th:action="@{/tweet}" method="post" modelAttribute="tweet" enctype="multipart/form-data">
                                <input type="hidden" th:value="${tweet.id}" name="id">
                                <input maxlength="140" th:value="${tweet.message}" class="new-tweet-input" type="text" placeholder="What's happening?" name="message">
                                <div class="upload-btn-wrapper">
                                    <button type="submit" class="btn">
                                        <img class="upload-image-icon" th:src="@{'/assets/upload-icon.png'}">
                                    </button>
                                    <input accept="image/gif,image/jpeg,image/jpg,image/png" type="file" name="file" />
                                </div>
                            </form>
                        </div>
                    </div>

                    <!--------- TWEET FEED --------->
                    <div th:each="t : ${feedTweets}">

                        <!--------- NEW TWEET --------->
                        <div th:if="${t.newTweet == null}">
                            <div class="tweetbox">

                                <div class="tweetbox-image-box">
                                    <img class="tweet-profile-pic" th:src="@{'/static/images/profile/' + ${t.profileImageName} }" alt="">
                                </div>

                                <div class="tweetbox-content">
                                    <div class="name-field">

                                        <a th:href="@{'/profile/' + ${t.user_id} }">
                                            <span class="name" th:text="${t.firstName} + ' ' + ${t.lastName}"></span>
                                            <span class="grey-text" th:text="' @' + ${t.userName}"></span>
                                        </a>


                                        <span class="grey-text">⋅</span>
                                        <span class="grey-text" th:text="${t.dateTime}"></span>
                                        <br>
                                        <span class="tweet-message" th:text="${t.message}"></span>
                                    </div>

                                    <img th:if="${t.imageName != null}" class="tweet-pic" th:src="@{'/static/images/tweet/' + ${t.imageName} }" alt="">

                                    <div class="interaction-field">

                                        <table>
                                            <tbody>
                                            <tr>
                                                <td class="interaction-item">
                                                    <img class="icon" th:src="@{'/assets/comment.png'}">
                                                    <span class="interaction-text">42</span>
                                                </td>
                                                <td class="interaction-item">

                                                    <form th:action="@{'/retweet/' + ${t.tweet_id} }" method="post" modelAttribute="retweet">

                                                        <input type="hidden" th:value="${retweet.rid}" name="rid">

                                                        <a class="no-text-decoration" href="#" onclick="this.parentNode.submit();">
                                                            <div class="interaction-div">
                                                                <img class="retweet-icon" th:src="@{'/assets/gray-retweet.svg'}">
                                                                <span class="interaction-text">0</span>
                                                            </div>

                                                        </a>

                                                    </form>

                                                </td>
                                                <td class="interaction-item">
                                                    <img class="icon" th:src="@{'/assets/heart.png'}">
                                                    <span class="interaction-text">89</span>
                                                </td>
                                            </tr>
                                            </tbody>
                                        </table>

                                    </div>

                                </div>

                            </div>
                        </div>

                        <!--

                        <a style="font-size: 0.9em" th:href="@{'/deleteTweet/' + ${t.id} }">Delete</a>

                        <a style="font-size: 0.9em" href="#">Like</a>

                        <a style="font-size: 0.9em" href="#">Share</a>

                        -->

                        <!--------- RETWEET --------->
                        <div th:if="${t.newTweet != null}">

                            <div class="tweetbox">

                                <div class="retweet-box">
                                    <a th:href="@{'/profile/' + ${t.user_id} }">
                                        <img class="user-retweet-icon" th:src="@{'/assets/gray-retweet.svg'}">
                                        <span class="retweeted-text" th:text="${t.firstName} + ' ' + ${t.lastName} + ' Retweeted' "></span>
                                    </a>
                                </div>

                                <div class="tweetbox-image-box">
                                    <img class="tweet-profile-pic" th:src="@{'/static/images/profile/' + ${t.newTweet.profileImageName} }" alt="">
                                </div>

                                <div class="tweetbox-content">
                                    <div class="name-field">
                                        <a th:href="@{'/profile/' + ${t.newTweet.user_id} }">
                                            <span class="name" th:text="${t.newTweet.firstName} + ' ' + ${t.newTweet.lastName}"></span>
                                            <span class="grey-text" th:text="' @' + ${t.newTweet.userName}"></span>
                                        </a>
                                        <span class="grey-text">⋅</span>
                                        <span class="grey-text" th:text="${t.newTweet.dateTime}"></span>
                                        <br>
                                        <span class="tweet-message" th:text="${t.newTweet.message}"></span>
                                    </div>

                                    <img th:if="${t.newTweet.imageName != null}" class="tweet-pic" th:src="@{'/static/images/tweet/' + ${t.newTweet.imageName} }" alt="">

                                    <div class="interaction-field">

                                        <table>
                                            <tbody>
                                            <tr>
                                                <td class="interaction-item">
                                                    <img class="icon" th:src="@{'/assets/comment.png'}">
                                                    <span class="interaction-text">42</span>
                                                </td>
                                                <td class="interaction-item">


                                                    <form th:action="@{'/retweet/' + ${t.newTweet.tweet_id} }" method="post" modelAttribute="retweet">

                                                        <input type="hidden" th:value="${retweet.rid}" name="rid">

                                                        <a class="no-text-decoration" href="#" onclick="this.parentNode.submit();">
                                                            <div class="interaction-div">
                                                                <img class="retweet-icon" th:src="@{'/assets/gray-retweet.svg'}">
                                                                <span class="interaction-text">0</span>
                                                            </div>

                                                        </a>

                                                    </form>

                                                </td>
                                                <td class="interaction-item">
                                                    <img class="icon" th:src="@{'/assets/heart.png'}">
                                                    <span class="interaction-text">89</span>
                                                </td>
                                            </tr>
                                            </tbody>
                                        </table>

                                    </div>

                                </div>

                            </div>

                            <!--
                            <a style="font-size: 0.9em" th:href="@{'/deleteRetweet/' + ${t.newTweet.id} }">Undo retweet</a>

                            <a style="font-size: 0.9em" href="#">Like</a>
                            <a style="font-size: 0.9em" href="#">Share</a>
                            -->

                        </div>

                    </div>

                </div>

                <div class="col-3">
                    <!--------- FOLLOW BOX --------->
                    <div class="follow-box"></div>
                </div>

            </div>

        </div>
    </body>
</html>